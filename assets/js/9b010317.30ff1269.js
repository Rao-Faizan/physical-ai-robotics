"use strict";(globalThis.webpackChunkphysical_ai_robotics=globalThis.webpackChunkphysical_ai_robotics||[]).push([[3384],{734:(n,i,r)=>{r.d(i,{A:()=>e});const e=r.p+"assets/images/ai-17-7cb3d6daa8bb40a5ad26c69dd0ec4966.png"},3077:(n,i,r)=>{r.r(i),r.d(i,{assets:()=>a,contentTitle:()=>l,default:()=>u,frontMatter:()=>o,metadata:()=>e,toc:()=>c});const e=JSON.parse('{"id":"module-02-simulation/week-7-unity","title":"Week 7: Unity for Robotics","description":"Unity for Robotics","source":"@site/docs/module-02-simulation/week-7-unity.md","sourceDirName":"module-02-simulation","slug":"/module-02-simulation/week-7-unity","permalink":"/physical-ai-robotics/docs/module-02-simulation/week-7-unity","draft":false,"unlisted":false,"editUrl":"https://github.com/Rao-Faizan/physical-ai-robotics/tree/main/frontend/docs/module-02-simulation/week-7-unity.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Week 7: Sensor Simulation","permalink":"/physical-ai-robotics/docs/module-02-simulation/week-7-sensors"},"next":{"title":"Week 7: Building Custom Simulation Worlds","permalink":"/physical-ai-robotics/docs/module-02-simulation/week-7-worlds"}}');var t=r(4848),s=r(8453);const o={},l="Week 7: Unity for Robotics",a={},c=[{value:"Why Unity for Robotics?",id:"why-unity-for-robotics",level:2},{value:"Installation and Setup",id:"installation-and-setup",level:2},{value:"URDF Importer: From ROS to Unity",id:"urdf-importer-from-ros-to-unity",level:2},{value:"Articulation Bodies: Unity&#39;s Multi-Body Physics",id:"articulation-bodies-unitys-multi-body-physics",level:2},{value:"PhysX Engine Configuration",id:"physx-engine-configuration",level:2},{value:"ROS2 Integration: Publishing Joint States",id:"ros2-integration-publishing-joint-states",level:2},{value:"Unity ML-Agents for Reinforcement Learning",id:"unity-ml-agents-for-reinforcement-learning",level:2}];function d(n){const i={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.header,{children:(0,t.jsx)(i.h1,{id:"week-7-unity-for-robotics",children:"Week 7: Unity for Robotics"})}),"\n",(0,t.jsx)(i.p,{children:(0,t.jsx)(i.img,{alt:"Unity for Robotics",src:r(734).A+"",width:"675",height:"1200"})}),"\n",(0,t.jsx)(i.h2,{id:"why-unity-for-robotics",children:"Why Unity for Robotics?"}),"\n",(0,t.jsxs)(i.p,{children:["While Gazebo excels at ROS2 integration, ",(0,t.jsx)(i.strong,{children:"Unity"})," offers:"]}),"\n",(0,t.jsxs)(i.ol,{children:["\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Photorealistic Rendering"}),": Essential for vision-based policies and sim-to-real transfer"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"NVIDIA PhysX"}),": High-performance physics with GPU acceleration"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"ML-Agents Integration"}),": Built-in reinforcement learning framework"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"VR/AR Support"}),": Human-robot interaction studies and teleoperation"]}),"\n"]}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"Unity Robotics Hub"})," bridges Unity with ROS2 via TCP, enabling seamless integration."]}),"\n",(0,t.jsx)(i.h2,{id:"installation-and-setup",children:"Installation and Setup"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-bash",children:"# Prerequisites: Unity 2021.3 LTS or later\r\n# Download Unity Hub from https://unity.com/download\r\n\r\n# Install Unity Robotics Hub packages in Unity:\r\n# 1. Open Unity Editor\r\n# 2. Window \u2192 Package Manager \u2192 Add package from git URL:\r\n#    - com.unity.robotics.urdf-importer\r\n#    - com.unity.robotics.ros-tcp-connector\r\n\r\n# Install ROS2 side (ROS-TCP-Endpoint)\r\ncd ~/ros2_ws/src\r\ngit clone https://github.com/Unity-Technologies/ROS-TCP-Endpoint.git\r\ncd ~/ros2_ws\r\ncolcon build --packages-select ros_tcp_endpoint\r\nsource install/setup.bash\r\n\r\n# Launch ROS2 endpoint (bridge)\r\nros2 run ros_tcp_endpoint default_server_endpoint --ros-args -p ROS_IP:=127.0.0.1\n"})}),"\n",(0,t.jsx)(i.h2,{id:"urdf-importer-from-ros-to-unity",children:"URDF Importer: From ROS to Unity"}),"\n",(0,t.jsxs)(i.p,{children:["Unity uses ",(0,t.jsx)(i.strong,{children:"articulation bodies"})," (PhysX feature) for multi-body dynamics. The URDF importer converts ROS robot descriptions to Unity GameObjects."]}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"Workflow"}),":"]}),"\n",(0,t.jsxs)(i.ol,{children:["\n",(0,t.jsx)(i.li,{children:"Export URDF from ROS2 workspace (example: TurtleBot3)"}),"\n"]}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-bash",children:'# Locate URDF file\r\nfind ~/ros2_ws/src -name "*.urdf"\r\n# Example: ~/ros2_ws/src/turtlebot3/turtlebot3_description/urdf/turtlebot3_waffle.urdf\n'})}),"\n",(0,t.jsxs)(i.ol,{start:"2",children:["\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsx)(i.p,{children:"Import in Unity:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:(0,t.jsx)(i.code,{children:"Assets \u2192 Import Robot from URDF"})}),"\n",(0,t.jsxs)(i.li,{children:["Select ",(0,t.jsx)(i.code,{children:".urdf"})," file"]}),"\n",(0,t.jsxs)(i.li,{children:["Choose ",(0,t.jsx)(i.strong,{children:"Import Settings"}),":","\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Mesh Decomposition"}),": Convex hull (faster collision)"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Axis Type"}),": Y-Up (Unity convention)"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Articulation Body"}),": Enabled"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsx)(i.p,{children:"Result: GameObject hierarchy with:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"ArticulationBody"})," components (joints)"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"MeshRenderer"})," (visual)"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"MeshCollider"})," (collision)"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"Example: Simple 2-DOF Arm in URDF"}),":"]}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-xml",children:'\x3c!-- two_dof_arm.urdf --\x3e\r\n<robot name="simple_arm">\r\n  <link name="base_link">\r\n    <visual>\r\n      <geometry><box size="0.1 0.1 0.2"/></geometry>\r\n      <material name="blue"><color rgba="0 0 1 1"/></material>\r\n    </visual>\r\n    <collision>\r\n      <geometry><box size="0.1 0.1 0.2"/></geometry>\r\n    </collision>\r\n    <inertial>\r\n      <mass value="2.0"/>\r\n      <inertia ixx="0.01" ixy="0" ixz="0" iyy="0.01" iyz="0" izz="0.005"/>\r\n    </inertial>\r\n  </link>\r\n\r\n  <joint name="shoulder_joint" type="revolute">\r\n    <parent link="base_link"/>\r\n    <child link="upper_arm"/>\r\n    <origin xyz="0 0 0.1" rpy="0 0 0"/>\r\n    <axis xyz="0 0 1"/> \x3c!-- Rotate around Z --\x3e\r\n    <limit lower="-1.57" upper="1.57" effort="10" velocity="2.0"/>\r\n  </joint>\r\n\r\n  <link name="upper_arm">\r\n    <visual>\r\n      <geometry><cylinder radius="0.05" length="0.3"/></geometry>\r\n      <material name="red"><color rgba="1 0 0 1"/></material>\r\n    </visual>\r\n    <collision>\r\n      <geometry><cylinder radius="0.05" length="0.3"/></geometry>\r\n    </collision>\r\n    <inertial>\r\n      <mass value="1.0"/>\r\n      <inertia ixx="0.008" ixy="0" ixz="0" iyy="0.008" iyz="0" izz="0.001"/>\r\n    </inertial>\r\n  </link>\r\n</robot>\n'})}),"\n",(0,t.jsx)(i.p,{children:"After import, Unity creates:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.code,{children:"base_link"})," (GameObject with ArticulationBody, immovable anchor)"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.code,{children:"upper_arm"})," (child GameObject, ArticulationBody with revolute joint)"]}),"\n"]}),"\n",(0,t.jsx)(i.h2,{id:"articulation-bodies-unitys-multi-body-physics",children:"Articulation Bodies: Unity's Multi-Body Physics"}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"ArticulationBody"})," is Unity's solution for robotic chains (replaces legacy ConfigurableJoint). Key properties:"]}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-csharp",children:'// C# script to control joint (attach to upper_arm GameObject)\r\nusing UnityEngine;\r\n\r\npublic class JointController : MonoBehaviour\r\n{\r\n    private ArticulationBody articulationBody;\r\n\r\n    void Start()\r\n    {\r\n        articulationBody = GetComponent<ArticulationBody>();\r\n\r\n        // Configure joint drive (PD controller)\r\n        var drive = articulationBody.xDrive;\r\n        drive.stiffness = 1000f;  // P gain (position control)\r\n        drive.damping = 100f;     // D gain (velocity damping)\r\n        drive.forceLimit = 10f;   // Max torque (10 Nm)\r\n        articulationBody.xDrive = drive;\r\n    }\r\n\r\n    void Update()\r\n    {\r\n        // Set target position (in degrees)\r\n        float targetAngle = Mathf.Sin(Time.time) * 90f; // Oscillate \xb190\xb0\r\n\r\n        var drive = articulationBody.xDrive;\r\n        drive.target = targetAngle;\r\n        articulationBody.xDrive = drive;\r\n\r\n        // Read current joint state\r\n        float currentAngle = articulationBody.jointPosition[0] * Mathf.Rad2Deg;\r\n        float currentVelocity = articulationBody.jointVelocity[0];\r\n\r\n        Debug.Log($"Joint Angle: {currentAngle:F2}\xb0, Velocity: {currentVelocity:F2} rad/s");\r\n    }\r\n}\n'})}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"Key Difference from Gazebo"}),": Unity uses ",(0,t.jsx)(i.strong,{children:"implicit spring-damper drives"})," (built-in PD control), while Gazebo requires external controllers via plugins."]}),"\n",(0,t.jsx)(i.h2,{id:"physx-engine-configuration",children:"PhysX Engine Configuration"}),"\n",(0,t.jsxs)(i.p,{children:["Unity's ",(0,t.jsx)(i.strong,{children:"PhysX"})," requires tuning for stable humanoid simulation."]}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"Project Settings \u2192 Physics"}),":"]}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-csharp",children:"// Script to configure physics at runtime (attach to empty GameObject)\r\nusing UnityEngine;\r\n\r\npublic class PhysicsConfig : MonoBehaviour\r\n{\r\n    void Start()\r\n    {\r\n        // Global physics settings\r\n        Physics.gravity = new Vector3(0, -9.81f, 0); // Earth gravity\r\n        Physics.defaultSolverIterations = 12;        // Higher = more stable joints\r\n        Physics.defaultSolverVelocityIterations = 8; // Velocity constraint iterations\r\n\r\n        // Time settings (fixed timestep for physics)\r\n        Time.fixedDeltaTime = 0.01f; // 100 Hz physics update (0.01s)\r\n\r\n        // Articulation-specific settings\r\n        Physics.ArticulationSolverIterations = 16; // Critical for humanoid stability\r\n        Physics.ArticulationSolverVelocityIterations = 4;\r\n    }\r\n}\n"})}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"Stability Tips"}),":"]}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Solver Iterations"}),": Increase to 16-24 for humanoids (default 6 is too low)"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Fixed Timestep"}),": Keep at 0.01s (100Hz) or lower for multi-body stability"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Continuous Collision Detection"}),": Enable on fast-moving links (feet during swing phase)"]}),"\n"]}),"\n",(0,t.jsx)(i.h2,{id:"ros2-integration-publishing-joint-states",children:"ROS2 Integration: Publishing Joint States"}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"Unity \u2192 ROS2 Communication"}),":"]}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-csharp",children:'// Publish joint states to ROS2 (requires ROS-TCP-Connector)\r\nusing UnityEngine;\r\nusing Unity.Robotics.ROSTCPConnector;\r\nusing RosMessageTypes.Sensor;\r\n\r\npublic class JointStatePublisher : MonoBehaviour\r\n{\r\n    private ROSConnection ros;\r\n    private ArticulationBody[] joints;\r\n    private float publishInterval = 0.1f; // 10 Hz\r\n    private float timer = 0f;\r\n\r\n    void Start()\r\n    {\r\n        // Connect to ROS\r\n        ros = ROSConnection.GetOrCreateInstance();\r\n        ros.RegisterPublisher<JointStateMsg>("/joint_states");\r\n\r\n        // Find all articulation bodies in robot\r\n        joints = GetComponentsInChildren<ArticulationBody>();\r\n    }\r\n\r\n    void FixedUpdate()\r\n    {\r\n        timer += Time.fixedDeltaTime;\r\n\r\n        if (timer >= publishInterval)\r\n        {\r\n            timer = 0f;\r\n            PublishJointStates();\r\n        }\r\n    }\r\n\r\n    void PublishJointStates()\r\n    {\r\n        var msg = new JointStateMsg\r\n        {\r\n            header = new RosMessageTypes.Std.HeaderMsg\r\n            {\r\n                stamp = new RosMessageTypes.Std.TimeMsg\r\n                {\r\n                    sec = (int)Time.time,\r\n                    nanosec = (uint)((Time.time % 1) * 1e9)\r\n                }\r\n            },\r\n            name = new string[joints.Length],\r\n            position = new double[joints.Length],\r\n            velocity = new double[joints.Length],\r\n            effort = new double[joints.Length]\r\n        };\r\n\r\n        for (int i = 0; i < joints.Length; i++)\r\n        {\r\n            msg.name[i] = joints[i].name;\r\n            msg.position[i] = joints[i].jointPosition[0]; // Radians\r\n            msg.velocity[i] = joints[i].jointVelocity[0]; // Rad/s\r\n            msg.effort[i] = joints[i].jointForce[0];      // Torque (Nm)\r\n        }\r\n\r\n        ros.Publish("/joint_states", msg);\r\n    }\r\n}\n'})}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"ROS2 Subscriber (verify data)"}),":"]}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-bash",children:"ros2 topic echo /joint_states\n"})}),"\n",(0,t.jsx)(i.h2,{id:"unity-ml-agents-for-reinforcement-learning",children:"Unity ML-Agents for Reinforcement Learning"}),"\n",(0,t.jsxs)(i.p,{children:["Unity's ",(0,t.jsx)(i.strong,{children:"ML-Agents"})," framework enables training policies directly in Unity (alternative to Isaac Gym)."]}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"Quick Start"}),":"]}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-csharp",children:"using Unity.MLAgents;\r\nusing Unity.MLAgents.Actuators;\r\nusing Unity.MLAgents.Sensors;\r\n\r\npublic class HumanoidAgent : Agent\r\n{\r\n    private ArticulationBody[] joints;\r\n\r\n    public override void Initialize()\r\n    {\r\n        joints = GetComponentsInChildren<ArticulationBody>();\r\n    }\r\n\r\n    // Observations: joint positions + velocities\r\n    public override void CollectObservations(VectorSensor sensor)\r\n    {\r\n        foreach (var joint in joints)\r\n        {\r\n            sensor.AddObservation(joint.jointPosition[0]); // Position\r\n            sensor.AddObservation(joint.jointVelocity[0]); // Velocity\r\n        }\r\n    }\r\n\r\n    // Actions: target joint angles\r\n    public override void OnActionReceived(ActionBuffers actions)\r\n    {\r\n        for (int i = 0; i < joints.Length; i++)\r\n        {\r\n            var drive = joints[i].xDrive;\r\n            drive.target = actions.ContinuousActions[i] * 90f; // \xb190\xb0 range\r\n            joints[i].xDrive = drive;\r\n        }\r\n    }\r\n\r\n    // Reward: standing upright\r\n    public void FixedUpdate()\r\n    {\r\n        float uprightBonus = transform.up.y; // 1.0 if perfectly vertical\r\n        AddReward(uprightBonus * 0.01f); // Small reward per step\r\n\r\n        if (transform.position.y < 0.5f) // Fell down\r\n        {\r\n            SetReward(-1f);\r\n            EndEpisode();\r\n        }\r\n    }\r\n}\n"})}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"Training"}),": Use ",(0,t.jsx)(i.code,{children:"mlagents-learn"})," (Python package) with PPO algorithm."]}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"Exercise"}),": Import a humanoid URDF into Unity. Create a C# script that applies sinusoidal joint commands to make the robot wave one arm. Publish joint states to ROS2 and visualize in RViz."]}),"\n",(0,t.jsx)(i.hr,{}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"Next"}),": ",(0,t.jsx)(i.a,{href:"/physical-ai-robotics/docs/module-02-simulation/week-7-worlds",children:"Week 7 - Building Custom Worlds"})," - Terrains, obstacles, and realistic environments."]})]})}function u(n={}){const{wrapper:i}={...(0,s.R)(),...n.components};return i?(0,t.jsx)(i,{...n,children:(0,t.jsx)(d,{...n})}):d(n)}},8453:(n,i,r)=>{r.d(i,{R:()=>o,x:()=>l});var e=r(6540);const t={},s=e.createContext(t);function o(n){const i=e.useContext(s);return e.useMemo(function(){return"function"==typeof n?n(i):{...i,...n}},[i,n])}function l(n){let i;return i=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:o(n.components),e.createElement(s.Provider,{value:i},n.children)}}}]);