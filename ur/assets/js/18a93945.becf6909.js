"use strict";(globalThis.webpackChunkphysical_ai_robotics=globalThis.webpackChunkphysical_ai_robotics||[]).push([[2939],{2186:(e,r,n)=>{n.d(r,{A:()=>i});const i=n.p+"assets/images/ai-13-ed01b228f10026021530f0817a1b229f.png"},8046:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>l,contentTitle:()=>a,default:()=>p,frontMatter:()=>o,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"module-04-vla/week-12-multimodal","title":"\u06c1\u0641\u062a\u06c1 12: \u0645\u0644\u0679\u06cc \u0645\u0648\u0688\u0644 \u0648\u0698\u0646-\u0632\u0628\u0627\u0646 \u0641\u06cc\u0648\u0698\u0646","description":"Multimodal Vision-Language Fusion","source":"@site/i18n/ur/docusaurus-plugin-content-docs/current/module-04-vla/week-12-multimodal.md","sourceDirName":"module-04-vla","slug":"/module-04-vla/week-12-multimodal","permalink":"/physical-ai-robotics/ur/docs/module-04-vla/week-12-multimodal","draft":false,"unlisted":false,"editUrl":"https://github.com/Rao-Faizan/physical-ai-robotics/tree/main/frontend/docs/module-04-vla/week-12-multimodal.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"\u06c1\u0641\u062a\u06c1 11: LLM \u0628\u06cc\u0633\u0688 \u0679\u0627\u0633\u06a9 \u0645\u0646\u0635\u0648\u0628\u06c1 \u0628\u0646\u062f\u06cc","permalink":"/physical-ai-robotics/ur/docs/module-04-vla/week-11-llm-planning"},"next":{"title":"\u06c1\u0641\u062a\u06c1 12: \u0627\u0646\u0633\u0627\u0646-\u0631\u0648\u0628\u0648\u0679 \u0627\u0646\u0679\u0631\u0627\u06cc\u06a9\u0634\u0646 \u06a9\u06d2 \u0644\u0626\u06d2 \u06af\u06cc\u0633\u0686\u0631 \u0631\u06cc\u06a9\u0648\u06af\u0646\u06cc\u0634\u0646","permalink":"/physical-ai-robotics/ur/docs/module-04-vla/week-12-gesture-recognition"}}');var t=n(4848),s=n(8453);const o={},a="\u06c1\u0641\u062a\u06c1 12: \u0645\u0644\u0679\u06cc \u0645\u0648\u0688\u0644 \u0648\u0698\u0646-\u0632\u0628\u0627\u0646 \u0641\u06cc\u0648\u0698\u0646",l={},c=[{value:"\u0648\u0698\u0646 \u0627\u0648\u0631 \u0632\u0628\u0627\u0646 \u06a9\u0627 \u0627\u0646\u0636\u0645\u0627\u0645",id:"\u0648\u0698\u0646-\u0627\u0648\u0631-\u0632\u0628\u0627\u0646-\u06a9\u0627-\u0627\u0646\u0636\u0645\u0627\u0645",level:2},{value:"\u0645\u0644\u0679\u06cc \u0645\u0648\u0688\u0644 \u0645\u0627\u0688\u0644\u0632 \u06a9\u06cc\u0648\u06ba\u061f",id:"\u0645\u0644\u0679\u06cc-\u0645\u0648\u0688\u0644-\u0645\u0627\u0688\u0644\u0632-\u06a9\u06cc\u0648\u06ba",level:3},{value:"\u0648\u06cc\u0698\u0648\u0626\u0644 \u062c\u0691\u0627\u0624 \u06a9\u06d2 \u0644\u0626\u06d2 CLIP",id:"\u0648\u06cc\u0698\u0648\u0626\u0644-\u062c\u0691\u0627\u0624-\u06a9\u06d2-\u0644\u0626\u06d2-clip",level:2},{value:"\u0627\u0646\u0633\u0679\u0627\u0644\u06cc\u0634\u0646 \u0627\u0648\u0631 \u0628\u0646\u06cc\u0627\u062f\u06cc \u0627\u0633\u062a\u0639\u0645\u0627\u0644",id:"\u0627\u0646\u0633\u0679\u0627\u0644\u06cc\u0634\u0646-\u0627\u0648\u0631-\u0628\u0646\u06cc\u0627\u062f\u06cc-\u0627\u0633\u062a\u0639\u0645\u0627\u0644",level:3},{value:"\u0627\u0634\u06cc\u0627\u0621 \u06a9\u06d2 \u0627\u0646\u062a\u062e\u0627\u0628 \u06a9\u06d2 \u0644\u0626\u06d2 \u0631\u06cc\u0641\u0631\u0646\u06af \u0627\u06cc\u06a9\u0633\u067e\u0631\u06cc\u0634\u0646\u0632",id:"\u0627\u0634\u06cc\u0627\u0621-\u06a9\u06d2-\u0627\u0646\u062a\u062e\u0627\u0628-\u06a9\u06d2-\u0644\u0626\u06d2-\u0631\u06cc\u0641\u0631\u0646\u06af-\u0627\u06cc\u06a9\u0633\u067e\u0631\u06cc\u0634\u0646\u0632",level:2},{value:"CLIP \u06a9\u06d2 \u0633\u0627\u062a\u06be \u0633\u067e\u06cc\u0634\u0644 \u062c\u0691\u0627\u0624",id:"clip-\u06a9\u06d2-\u0633\u0627\u062a\u06be-\u0633\u067e\u06cc\u0634\u0644-\u062c\u0691\u0627\u0624",level:3},{value:"\u0648\u06cc\u0698\u0648\u0626\u0644 \u06a9\u0648\u0626\u0633\u0686\u0646 \u0627\u06cc\u0646\u0633\u0631\u0646\u06af (VQA)",id:"\u0648\u06cc\u0698\u0648\u0626\u0644-\u06a9\u0648\u0626\u0633\u0686\u0646-\u0627\u06cc\u0646\u0633\u0631\u0646\u06af-vqa",level:2},{value:"GPT-4V (\u0648\u0698\u0646) \u06a9\u06d2 \u0633\u0627\u062a\u06be VQA",id:"gpt-4v-\u0648\u0698\u0646-\u06a9\u06d2-\u0633\u0627\u062a\u06be-vqa",level:3},{value:"\u0648\u0698\u0646-\u0632\u0628\u0627\u0646 \u06a9\u0627 \u0631\u0648\u0628\u0648\u0679 \u06a9\u0646\u0679\u0631\u0648\u0644 \u06a9\u06d2 \u0633\u0627\u062a\u06be \u0627\u0646\u0636\u0645\u0627\u0645",id:"\u0648\u0698\u0646-\u0632\u0628\u0627\u0646-\u06a9\u0627-\u0631\u0648\u0628\u0648\u0679-\u06a9\u0646\u0679\u0631\u0648\u0644-\u06a9\u06d2-\u0633\u0627\u062a\u06be-\u0627\u0646\u0636\u0645\u0627\u0645",level:2},{value:"\u0645\u0634\u0642 \u0648\u0631\u0632\u0634",id:"\u0645\u0634\u0642-\u0648\u0631\u0632\u0634",level:2},{value:"\u0627\u06af\u0644\u06d2 \u0627\u0642\u062f\u0627\u0645\u0627\u062a",id:"\u0627\u06af\u0644\u06d2-\u0627\u0642\u062f\u0627\u0645\u0627\u062a",level:2}];function d(e){const r={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.header,{children:(0,t.jsx)(r.h1,{id:"\u06c1\u0641\u062a\u06c1-12-\u0645\u0644\u0679\u06cc-\u0645\u0648\u0688\u0644-\u0648\u0698\u0646-\u0632\u0628\u0627\u0646-\u0641\u06cc\u0648\u0698\u0646",children:"\u06c1\u0641\u062a\u06c1 12: \u0645\u0644\u0679\u06cc \u0645\u0648\u0688\u0644 \u0648\u0698\u0646-\u0632\u0628\u0627\u0646 \u0641\u06cc\u0648\u0698\u0646"})}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.img,{alt:"Multimodal Vision-Language Fusion",src:n(2186).A+"",width:"576",height:"1024"})}),"\n",(0,t.jsx)(r.h2,{id:"\u0648\u0698\u0646-\u0627\u0648\u0631-\u0632\u0628\u0627\u0646-\u06a9\u0627-\u0627\u0646\u0636\u0645\u0627\u0645",children:"\u0648\u0698\u0646 \u0627\u0648\u0631 \u0632\u0628\u0627\u0646 \u06a9\u0627 \u0627\u0646\u0636\u0645\u0627\u0645"}),"\n",(0,t.jsx)(r.p,{children:'\u0645\u0644\u0679\u06cc \u0645\u0648\u0688\u0644 \u0645\u0627\u0688\u0644\u0632 \u0648\u06cc\u0698\u0648\u0626\u0644 \u0627\u0648\u0631 \u0679\u06cc\u06a9\u0633\u0679 \u0688\u06cc\u0679\u0627 \u06a9\u0648 \u0645\u0634\u062a\u0631\u06a9\u06c1 \u0637\u0648\u0631 \u067e\u0631 \u067e\u0631\u0648\u0633\u06cc\u0633 \u06a9\u0631\u062a\u06d2 \u06c1\u06cc\u06ba \u062a\u0627\u06a9\u06c1 \u0632\u0628\u0627\u0646 \u06a9\u0648 \u062c\u0633\u0645\u0627\u0646\u06cc \u0627\u062f\u0631\u0627\u06a9 \u0645\u06cc\u06ba \u062c\u0691 \u0633\u06a9\u06d2\u06d4 \u0631\u0648\u0628\u0648\u0679\u06a9\u0633 \u06a9\u06d2 \u0644\u0626\u06d2\u060c \u06cc\u06c1 \u0627\u0634\u06cc\u0627\u0621 \u06a9\u0648 \u0642\u062f\u0631\u062a\u06cc \u062a\u0641\u0635\u06cc\u0644\u0627\u062a ("\u0644\u0627\u0644 \u06c1\u06cc\u0646\u0688\u0644 \u0648\u0627\u0644\u0627 \u0645\u06af") \u06a9\u06d2 \u0630\u0631\u06cc\u0639\u06d2 \u067e\u06c1\u0686\u0627\u0646\u0646\u06d2 \u06a9\u06cc \u0627\u062c\u0627\u0632\u062a \u062f\u06cc\u062a\u0627 \u06c1\u06d2 \u0628\u062c\u0627\u0626\u06d2 \u0627\u0632 \u067e\u06c1\u0644\u06d2 \u062a\u06cc\u0627\u0631 \u06a9\u0631\u062f\u06c1 ID \u06cc\u0627 \u0628\u0627\u0624\u0646\u0688\u0646\u06af \u0628\u0627\u06a9\u0633 \u06a9\u0648\u0622\u0631\u0688\u06cc\u0646\u06cc\u0679\u0633 \u06a9\u06d2\u06d4 \u0648\u0698\u0646-\u0632\u0628\u0627\u0646 \u0641\u06cc\u0648\u0698\u0646 \u0627\u06cc\u0645\u0628\u06cc\u0688\u0688 AI \u0627\u06cc\u062c\u0646\u0679\u0633 \u06a9\u06d2 \u0644\u0626\u06d2 \u0636\u0631\u0648\u0631\u06cc \u06c1\u06d2 \u062c\u0648 \u06a9\u06be\u0644\u06cc \u062f\u0646\u06cc\u0627 \u06a9\u06d2 \u0645\u0627\u062d\u0648\u0644 \u0645\u06cc\u06ba \u06a9\u0627\u0645 \u06a9\u0631\u062a\u06d2 \u06c1\u06cc\u06ba \u062c\u06c1\u0627\u06ba \u0646\u0626\u06cc\u060c \u0646\u0627\u0645\u0639\u0644\u0648\u0645 \u0627\u0634\u06cc\u0627\u0621 \u06c1\u0648\u06ba\u06d4'}),"\n",(0,t.jsx)(r.h3,{id:"\u0645\u0644\u0679\u06cc-\u0645\u0648\u0688\u0644-\u0645\u0627\u0688\u0644\u0632-\u06a9\u06cc\u0648\u06ba",children:"\u0645\u0644\u0679\u06cc \u0645\u0648\u0688\u0644 \u0645\u0627\u0688\u0644\u0632 \u06a9\u06cc\u0648\u06ba\u061f"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u0635\u0641\u0631-\u0634\u0627\u0679 \u0627\u0634\u06cc\u0627\u0621 \u06a9\u06cc \u067e\u06c1\u0686\u0627\u0646"}),': \u0631\u0648\u0627\u06cc\u062a\u06cc \u0627\u0634\u06cc\u0627\u0621 \u06a9\u06d2 \u0688\u06cc\u0679\u06cc\u06a9\u0679\u0631\u0632 \u06a9\u0648 \u0644\u06cc\u0628\u0644 \u0634\u062f\u06c1 \u0688\u06cc\u0679\u0627 \u0633\u06cc\u0679\u0633 \u067e\u0631 \u062a\u0631\u0628\u06cc\u062a \u06a9\u06cc \u0636\u0631\u0648\u0631\u062a \u06c1\u0648\u062a\u06cc \u06c1\u06d2\u06d4 \u0645\u0644\u0679\u06cc \u0645\u0648\u0688\u0644 \u0645\u0627\u0688\u0644\u0632 \u0632\u0628\u0627\u0646\u06cc \u062a\u0641\u0635\u06cc\u0644\u0627\u062a \u06a9\u0648 \u0627\u0633\u062a\u0639\u0645\u0627\u0644 \u06a9\u0631\u062a\u06d2 \u06c1\u06cc\u06ba \u062a\u0627\u06a9\u06c1 \u0628\u063a\u06cc\u0631 \u062f\u0648\u0628\u0627\u0631\u06c1 \u062a\u0631\u0628\u06cc\u062a \u06a9\u06d2 \u0646\u0626\u06cc \u0627\u0642\u0633\u0627\u0645 \u06a9\u0648 \u067e\u06c1\u0686\u0627\u0646 \u0633\u06a9\u06cc\u06ba\u2014\u0627\u06cc\u06a9 \u06c1\u06cc\u0648\u0645\u0646\u0648\u0627\u0626\u0688 \u062c\u0648 "\u06a9\u0648\u0626\u0646\u0648\u0627" \u06a9\u0648 \u067e\u06c1\u0644\u06cc \u0628\u0627\u0631 \u062f\u06cc\u06a9\u06be\u062a\u0627 \u06c1\u06d2 \u0648\u06c1 \u0679\u06cc\u06a9\u0633\u0679-\u0627\u0645\u06cc\u062c \u06a9\u06cc \u0645\u0645\u0627\u062b\u0644\u062a \u06a9\u06d2 \u0630\u0631\u06cc\u0639\u06d2 \u0627\u0633\u06d2 \u067e\u06c1\u0686\u0627\u0646 \u0633\u06a9\u062a\u0627 \u06c1\u06d2\u06d4']}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u0633\u067e\u06cc\u0634\u0644 \u0631\u06cc\u0632\u0646\u0646\u06af"}),': \u0632\u0628\u0627\u0646\u06cc \u0645\u0627\u0688\u0644\u0632 \u0633\u067e\u06cc\u0634\u0644 \u0631\u06cc\u0644\u06cc\u0634\u0646 \u0634\u067e\u0633 ("\u0628\u0627\u0626\u06cc\u06ba \u0637\u0631\u0641"\u060c "\u067e\u06cc\u0686\u06be\u06d2") \u06a9\u0648 \u06a9\u0648\u0688 \u06a9\u0631\u062a\u06d2 \u06c1\u06cc\u06ba \u0644\u06cc\u06a9\u0646 \u0648\u06cc\u0698\u0648\u0626\u0644 \u062c\u0691\u0627\u0624 \u06a9\u0627 \u0641\u0642\u062f\u0627\u0646 \u06c1\u0648\u062a\u0627 \u06c1\u06d2\u06d4 \u0648\u0698\u0646-\u0632\u0628\u0627\u0646 \u0645\u0627\u0688\u0644\u0632 \u0633\u06cc\u06a9\u06be\u062a\u06d2 \u06c1\u06cc\u06ba \u06a9\u06c1 \u0627\u0646 \u0644\u06cc\u0646\u06af\u0648\u0626\u0633\u0679\u06a9 \u062a\u0635\u0648\u0631\u0627\u062a \u06a9\u0648 \u067e\u06a9\u0633\u0644 \u06a9\u0648\u0622\u0631\u0688\u06cc\u0646\u06cc\u0679\u0633 \u0645\u06cc\u06ba \u0645\u06cc\u067e \u06a9\u0631\u06cc\u06ba\u06d4']}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u0648\u0636\u0627\u062d\u062a"}),': \u0645\u0646\u0638\u0631 \u0645\u06cc\u06ba \u0645\u062a\u0639\u062f\u062f \u0645\u0645\u0627\u062b\u0644 \u0627\u0634\u06cc\u0627\u0621 \u06a9\u06d2 \u0633\u0627\u062a\u06be ("\u0628\u0627\u0626\u06cc\u06ba \u0637\u0631\u0641 \u0648\u0627\u0644\u0627 \u0644\u0627\u0644 \u0645\u06af")\u060c \u0648\u06cc\u0698\u0648\u0626\u0644 \u062c\u0691\u0627\u0624 \u06cc\u06c1 \u062d\u0644 \u06a9\u0631\u062a\u0627 \u06c1\u06d2 \u06a9\u06c1 \u06a9\u0648\u0646 \u0633\u0627 \u0648\u0627\u0642\u0639\u06c1 \u062a\u0641\u0635\u06cc\u0644 \u0633\u06d2 \u0645\u0645\u0627\u062b\u0644 \u06c1\u06d2\u06d4']}),"\n",(0,t.jsx)(r.h2,{id:"\u0648\u06cc\u0698\u0648\u0626\u0644-\u062c\u0691\u0627\u0624-\u06a9\u06d2-\u0644\u0626\u06d2-clip",children:"\u0648\u06cc\u0698\u0648\u0626\u0644 \u062c\u0691\u0627\u0624 \u06a9\u06d2 \u0644\u0626\u06d2 CLIP"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"CLIP (\u06a9\u0646\u0679\u0631\u0627\u0633\u0679\u0648 \u0644\u06cc\u0646\u06af\u0648\u06cc\u062c-\u0627\u0645\u06cc\u062c \u067e\u0631\u06cc \u0679\u0631\u06cc\u0646\u0646\u06af)"})," \u0627\u0645\u06cc\u062c \u0627\u0648\u0631 \u0679\u06cc\u06a9\u0633\u0679 \u06a9\u06d2 \u0644\u0626\u06d2 \u0627\u06cc\u06a9 \u0645\u0634\u062a\u0631\u06a9\u06c1 \u0627\u06cc\u0645\u0628\u06cc\u0688\u0646\u06af \u0633\u067e\u06cc\u0633 \u0633\u06cc\u06a9\u06be\u062a\u0627 \u06c1\u06d2 400 \u0645\u0644\u06cc\u0646 \u0627\u0645\u06cc\u062c-\u06a9\u06cc\u067e\u0634\u0646 \u062c\u0648\u0691\u06d2 \u067e\u0631 \u062a\u0631\u0628\u06cc\u062a \u06a9\u0631 \u06a9\u06d2 \u062c\u0648 \u0627\u0646\u0679\u0631\u0646\u06cc\u0679 \u0633\u06d2 \u06a9\u06be\u0631\u0686\u06d2 \u06af\u0626\u06d2 \u062a\u06be\u06d2\u06d4 \u0627\u06cc\u06a9 \u0627\u0645\u06cc\u062c \u0627\u0648\u0631 \u0645\u062a\u0639\u062f\u062f \u0679\u06cc\u06a9\u0633\u0679 \u062a\u0641\u0635\u06cc\u0644\u0627\u062a \u062f\u06cc\u06d2 \u062c\u0627\u0646\u06d2 \u067e\u0631\u060c CLIP \u0645\u06cc\u0644 \u06a9\u06be\u0627\u0646\u06d2 \u06a9\u06d2 \u0644\u0626\u06d2 \u0645\u0645\u0627\u062b\u0644\u062a \u0633\u06a9\u0648\u0631\u0632 \u06a9\u0627 \u062d\u0633\u0627\u0628 \u0644\u06af\u0627\u062a\u0627 \u06c1\u06d2\u06d4"]}),"\n",(0,t.jsx)(r.h3,{id:"\u0627\u0646\u0633\u0679\u0627\u0644\u06cc\u0634\u0646-\u0627\u0648\u0631-\u0628\u0646\u06cc\u0627\u062f\u06cc-\u0627\u0633\u062a\u0639\u0645\u0627\u0644",children:"\u0627\u0646\u0633\u0679\u0627\u0644\u06cc\u0634\u0646 \u0627\u0648\u0631 \u0628\u0646\u06cc\u0627\u062f\u06cc \u0627\u0633\u062a\u0639\u0645\u0627\u0644"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-python",children:'# OpenAI \u06a9\u06cc \u0633\u0631\u06a9\u0627\u0631\u06cc \u0631\u06cc\u067e\u0648\u0632\u0679\u0631\u06cc \u0633\u06d2 CLIP \u0627\u0646\u0633\u0679\u0627\u0644 \u06a9\u0631\u06cc\u06ba\r\nimport subprocess\r\nsubprocess.run(["pip", "install", "git+https://github.com/openai/CLIP.git", "pillow", "torch"])\r\n\r\nimport torch\r\nimport clip\r\nfrom PIL import Image\r\nimport numpy as np\r\n\r\n# \u067e\u0631\u06cc \u0679\u0631\u06cc\u0646\u0688 CLIP \u0645\u0627\u0688\u0644 \u0644\u0648\u0688 \u06a9\u0631\u06cc\u06ba\r\n# \u0627\u062e\u062a\u06cc\u0627\u0631\u0627\u062a: RN50\u060c RN101\u060c ViT-B/32\u060c ViT-L/14 (\u0628\u0691\u0627 = \u0632\u06cc\u0627\u062f\u06c1 \u062f\u0631\u0633\u062a \u0644\u06cc\u06a9\u0646 \u0633\u0633\u062a)\r\ndevice = "cuda" if torch.cuda.is_available() else "cpu"\r\nmodel, preprocess = clip.load("ViT-B/32", device=device)\r\n\r\ndef ground_object_in_image(image_path: str, text_queries: list) -> dict:\r\n    """\r\n    \u0645\u0639\u0644\u0648\u0645 \u06a9\u0631\u06cc\u06ba \u06a9\u06c1 \u06a9\u0648\u0646 \u0633\u06cc \u0679\u06cc\u06a9\u0633\u0679 \u062a\u0641\u0635\u06cc\u0644 \u0627\u0645\u06cc\u062c \u0633\u06d2 \u0628\u06c1\u062a\u0631\u06cc\u0646 \u0645\u0645\u0627\u062b\u0644\u062a \u0631\u06a9\u06be\u062a\u06cc \u06c1\u06d2\u06d4\r\n\r\n    Args:\r\n        image_path: \u0627\u0645\u06cc\u062c \u0641\u0627\u0626\u0644 \u06a9\u0627 \u0631\u0627\u0633\u062a\u06c1\r\n        text_queries: \u0645\u0648\u0627\u0632\u0646\u06c1 \u06a9\u06d2 \u0644\u0626\u06d2 \u0679\u06cc\u06a9\u0633\u0679 \u062a\u0641\u0635\u06cc\u0644\u0627\u062a \u06a9\u06cc \u0641\u06c1\u0631\u0633\u062a\r\n    Returns:\r\n        dict: {\r\n            \'best_match\': str,\r\n            \'scores\': dict query \u06a9\u0648 \u0645\u0645\u0627\u062b\u0644\u062a \u0633\u06a9\u0648\u0631 \u0645\u06cc\u06ba \u0645\u06cc\u067e \u06a9\u0631\u062a\u0627 \u06c1\u06d2\r\n        }\r\n    """\r\n    # \u0627\u0645\u06cc\u062c \u0644\u0648\u0688 \u0627\u0648\u0631 \u067e\u0631\u06cc \u067e\u0631\u0648\u0633\u06cc\u0633 \u06a9\u0631\u06cc\u06ba\r\n    image = Image.open(image_path)\r\n    image_input = preprocess(image).unsqueeze(0).to(device)\r\n\r\n    # \u0679\u06cc\u06a9\u0633\u0679 \u06a9\u0648\u06cc\u0631\u06cc\u0632 \u0679\u0648\u06a9\u0646\u0627\u0626\u0632 \u06a9\u0631\u06cc\u06ba\r\n    text_inputs = clip.tokenize(text_queries).to(device)\r\n\r\n    # \u0627\u06cc\u0645\u0628\u06cc\u0688\u0646\u06af\u0632 \u06a9\u0627 \u062d\u0633\u0627\u0628 \u0644\u06af\u0627\u0626\u06cc\u06ba\r\n    with torch.no_grad():\r\n        image_features = model.encode_image(image_input)  # Shape: [1, 512]\r\n        text_features = model.encode_text(text_inputs)    # Shape: [N, 512]\r\n\r\n        # \u0641\u06cc\u0686\u0631\u0632 \u06a9\u0648 \u06cc\u0648\u0646\u0679 \u0648\u06cc\u06a9\u0679\u0631\u0632 \u0645\u06cc\u06ba \u0646\u0627\u0631\u0645\u0644\u0627\u0626\u0632 \u06a9\u0631\u06cc\u06ba\r\n        image_features /= image_features.norm(dim=-1, keepdim=True)\r\n        text_features /= text_features.norm(dim=-1, keepdim=True)\r\n\r\n        # \u06a9\u0648\u0633\u0627\u0626\u0646\u0632 \u0645\u0645\u0627\u062b\u0644\u062a \u06a9\u0627 \u062d\u0633\u0627\u0628 \u0644\u06af\u0627\u0626\u06cc\u06ba (\u06cc\u0648\u0646\u0679 \u0648\u06cc\u06a9\u0679\u0631\u0632 \u06a9\u0627 \u0688\u0627\u0679 \u067e\u0631\u0648\u0688\u06a9\u0679)\r\n        similarity = (image_features @ text_features.T).squeeze(0)  # Shape: [N]\r\n\r\n        # \u0633\u0627\u0641\u0679 \u0645\u06cc\u06a9\u0633 \u06a9\u0627 \u0627\u0633\u062a\u0639\u0645\u0627\u0644 \u06a9\u0631\u062a\u06d2 \u06c1\u0648\u0626\u06d2 \u0627\u0645\u06a9\u0627\u0646\u0627\u062a \u0645\u06cc\u06ba \u062a\u0628\u062f\u06cc\u0644 \u06a9\u0631\u06cc\u06ba\r\n        probabilities = similarity.softmax(dim=0).cpu().numpy()\r\n\r\n    # \u0646\u062a\u0627\u0626\u062c \u06a9\u0627 \u0688\u06a9\u0634\u0646\u0631\u06cc \u062a\u06cc\u0627\u0631 \u06a9\u0631\u06cc\u06ba\r\n    scores = {query: float(prob) for query, prob in zip(text_queries, probabilities)}\r\n    best_match = text_queries[probabilities.argmax()]\r\n\r\n    return {\r\n        \'best_match\': best_match,\r\n        \'scores\': scores\r\n    }\r\n\r\n# \u0645\u062b\u0627\u0644: \u06a9\u0686\u0646 \u0645\u0646\u0638\u0631 \u0645\u06cc\u06ba \u0627\u0634\u06cc\u0627\u0621 \u06a9\u06cc \u062a\u0635\u0646\u06cc\u0641\r\nqueries = [\r\n    "a red coffee mug",\r\n    "a white plate",\r\n    "a stainless steel fork",\r\n    "a glass of water"\r\n]\r\n\r\nresult = ground_object_in_image("kitchen_counter.jpg", queries)\r\nprint(f"Best match: {result[\'best_match\']}")\r\nprint("\\nAll scores:")\r\nfor query, score in result[\'scores\'].items():\r\n    print(f"  {query}: {score:.3f}")\r\n\r\n# Output:\r\n# Best match: a red coffee mug\r\n# All scores:\r\n#   a red coffee mug: 0.782\r\n#   a white plate: 0.124\r\n#   a stainless steel fork: 0.061\r\n#   a glass of water: 0.033\n'})}),"\n",(0,t.jsx)(r.h2,{id:"\u0627\u0634\u06cc\u0627\u0621-\u06a9\u06d2-\u0627\u0646\u062a\u062e\u0627\u0628-\u06a9\u06d2-\u0644\u0626\u06d2-\u0631\u06cc\u0641\u0631\u0646\u06af-\u0627\u06cc\u06a9\u0633\u067e\u0631\u06cc\u0634\u0646\u0632",children:"\u0627\u0634\u06cc\u0627\u0621 \u06a9\u06d2 \u0627\u0646\u062a\u062e\u0627\u0628 \u06a9\u06d2 \u0644\u0626\u06d2 \u0631\u06cc\u0641\u0631\u0646\u06af \u0627\u06cc\u06a9\u0633\u067e\u0631\u06cc\u0634\u0646\u0632"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u0631\u06cc\u0641\u0631\u0646\u06af \u0627\u06cc\u06a9\u0633\u067e\u0631\u06cc\u0634\u0646\u0632"})," \u0627\u0648\u0635\u0627\u0641 (\u0631\u0646\u06af\u060c \u0634\u06a9\u0644)\u060c \u0633\u067e\u06cc\u0634\u0644 \u0631\u06cc\u0644\u06cc\u0634\u0646\u0632 (\u0628\u0627\u0626\u06cc\u06ba\u060c \u067e\u06cc\u0686\u06be\u06d2)\u060c \u0627\u0648\u0631 \u0641\u0646\u06a9\u0634\u0646\u0644 \u062a\u0641\u0635\u06cc\u0644\u0627\u062a (\u067e\u06cc\u0646\u06d2 \u06a9\u06d2 \u0644\u0626\u06d2) \u06a9\u0627 \u0627\u0633\u062a\u0639\u0645\u0627\u0644 \u06a9\u0631\u062a\u06d2 \u06c1\u0648\u0626\u06d2 \u0627\u0634\u06cc\u0627\u0621 \u06a9\u06cc \u0645\u0646\u0641\u0631\u062f \u067e\u06c1\u0686\u0627\u0646 \u06a9\u0631\u062a\u06d2 \u06c1\u06cc\u06ba\u06d4 \u0633\u0627\u062f\u06c1 \u0627\u0634\u06cc\u0627\u0621 \u06a9\u06d2 \u0688\u06cc\u0679\u06cc\u06a9\u0634\u0646 \u06a9\u06d2 \u0645\u0642\u0627\u0628\u0644\u06d2\u060c \u0627\u0633 \u06a9\u0648 \u06a9\u0645\u067e\u0648\u0632\u06cc\u0634\u0646\u0644 \u0631\u06cc\u0632\u0646\u0646\u06af \u06a9\u06cc \u0636\u0631\u0648\u0631\u062a \u06c1\u0648\u062a\u06cc \u06c1\u06d2\u06d4"]}),"\n",(0,t.jsx)(r.h3,{id:"clip-\u06a9\u06d2-\u0633\u0627\u062a\u06be-\u0633\u067e\u06cc\u0634\u0644-\u062c\u0691\u0627\u0624",children:"CLIP \u06a9\u06d2 \u0633\u0627\u062a\u06be \u0633\u067e\u06cc\u0634\u0644 \u062c\u0691\u0627\u0624"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-python",children:'import cv2\r\nfrom typing import List, Tuple\r\n\r\ndef detect_objects_with_clip(\r\n    image_path: str,\r\n    object_descriptions: List[str],\r\n    grid_size: int = 8\r\n) -> List[Tuple[str, int, int, float]]:\r\n    """\r\n    \u0633\u0644\u0627\u0626\u06cc\u0688\u0646\u06af \u0648\u0646\u0688\u0648 CLIP \u0627\u0633\u06a9\u0648\u0631\u0646\u06af \u06a9\u0627 \u0627\u0633\u062a\u0639\u0645\u0627\u0644 \u06a9\u0631\u062a\u06d2 \u06c1\u0648\u0626\u06d2 \u0627\u0645\u06cc\u062c \u0645\u06cc\u06ba \u0627\u0634\u06cc\u0627\u0621 \u06a9\u0648 \u0644\u0648\u06a9\u0644\u0627\u0626\u0632 \u06a9\u0631\u06cc\u06ba\u06d4\r\n\r\n    Args:\r\n        image_path: \u0627\u0646 \u067e\u0679 \u0627\u0645\u06cc\u062c\r\n        object_descriptions: \u062a\u0644\u0627\u0634 \u06a9\u0631\u0646\u06d2 \u06a9\u06d2 \u0644\u0626\u06d2 \u0679\u06cc\u06a9\u0633\u0679 \u062a\u0641\u0635\u06cc\u0644\u0627\u062a \u06a9\u06cc \u0641\u06c1\u0631\u0633\u062a\r\n        grid_size: \u0627\u0645\u06cc\u062c \u06a9\u0648 grid_size x grid_size \u0639\u0644\u0627\u0642\u0648\u06ba \u0645\u06cc\u06ba \u062a\u0642\u0633\u06cc\u0645 \u06a9\u0631\u06cc\u06ba\r\n    Returns:\r\n        (description, x, y, score) \u06a9\u06cc \u0641\u06c1\u0631\u0633\u062a \u062a\u06cc\u0627\u0631 \u06a9\u06cc \u06af\u0626\u06cc \u0627\u0634\u06cc\u0627\u0621 \u06a9\u06d2 \u0644\u0626\u06d2\r\n    """\r\n    # \u0627\u0645\u06cc\u062c \u0644\u0648\u0688 \u06a9\u0631\u06cc\u06ba\r\n    image = Image.open(image_path)\r\n    img_width, img_height = image.size\r\n\r\n    # \u0639\u0644\u0627\u0642\u06c1 \u06a9\u06d2 \u0627\u0628\u0639\u0627\u062f \u06a9\u0627 \u062d\u0633\u0627\u0628 \u0644\u06af\u0627\u0626\u06cc\u06ba\r\n    region_width = img_width // grid_size\r\n    region_height = img_height // grid_size\r\n\r\n    detections = []\r\n\r\n    for desc in object_descriptions:\r\n        best_score = 0\r\n        best_position = (0, 0)\r\n\r\n        # \u06af\u0631\u0688 \u0639\u0644\u0627\u0642\u0648\u06ba \u067e\u0631 \u0633\u0644\u0627\u0626\u06cc\u0688 \u06a9\u0631\u06cc\u06ba\r\n        for i in range(grid_size):\r\n            for j in range(grid_size):\r\n                # \u0639\u0644\u0627\u0642\u06c1 \u0646\u06a9\u0627\u0644\u06cc\u06ba\r\n                left = j * region_width\r\n                top = i * region_height\r\n                right = left + region_width\r\n                bottom = top + region_height\r\n\r\n                region = image.crop((left, top, right, bottom))\r\n                region_input = preprocess(region).unsqueeze(0).to(device)\r\n\r\n                # \u0627\u0633 \u0639\u0644\u0627\u0642\u06d2 \u06a9\u06d2 \u0644\u0626\u06d2 CLIP \u0633\u06a9\u0648\u0631 \u06a9\u0627 \u062d\u0633\u0627\u0628 \u0644\u06af\u0627\u0626\u06cc\u06ba\r\n                text_input = clip.tokenize([desc]).to(device)\r\n\r\n                with torch.no_grad():\r\n                    image_features = model.encode_image(region_input)\r\n                    text_features = model.encode_text(text_input)\r\n\r\n                    image_features /= image_features.norm(dim=-1, keepdim=True)\r\n                    text_features /= text_features.norm(dim=-1, keepdim=True)\r\n\r\n                    score = (image_features @ text_features.T).item()\r\n\r\n                # \u0627\u0633 \u0634\u06d2 \u06a9\u06d2 \u0644\u0626\u06d2 \u0633\u0628 \u0633\u06d2 \u0632\u06cc\u0627\u062f\u06c1 \u0627\u0633\u06a9\u0648\u0631 \u0648\u0627\u0644\u06d2 \u0639\u0644\u0627\u0642\u06d2 \u06a9\u0648 \u0679\u0631\u06cc\u06a9 \u06a9\u0631\u06cc\u06ba\r\n                if score > best_score:\r\n                    best_score = score\r\n                    best_position = (left + region_width // 2, top + region_height // 2)\r\n\r\n        detections.append((desc, best_position[0], best_position[1], best_score))\r\n\r\n    return detections\r\n\r\n# \u0645\u062b\u0627\u0644: \u0645\u062a\u0639\u062f\u062f \u0627\u0634\u06cc\u0627\u0621 \u06a9\u0648 \u0644\u0648\u06a9\u06cc\u0679 \u06a9\u0631\u06cc\u06ba\r\nobjects = ["red mug", "laptop computer", "potted plant"]\r\ndetections = detect_objects_with_clip("desk_scene.jpg", objects, grid_size=6)\r\n\r\nfor obj, x, y, score in detections:\r\n    print(f"{obj}: position ({x}, {y}), confidence {score:.3f}")\r\n\r\n# \u0646\u062a\u0627\u0626\u062c \u06a9\u0648 \u0648\u0698\u0648\u0626\u0644\u0627\u0626\u0632 \u06a9\u0631\u06cc\u06ba\r\nimage = cv2.imread("desk_scene.jpg")\r\nfor obj, x, y, score in detections:\r\n    cv2.circle(image, (x, y), 10, (0, 255, 0), -1)\r\n    cv2.putText(image, obj, (x + 15, y), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (255, 255, 255), 2)\r\n\r\ncv2.imwrite("detected_objects.jpg", image)\n'})}),"\n",(0,t.jsx)(r.h2,{id:"\u0648\u06cc\u0698\u0648\u0626\u0644-\u06a9\u0648\u0626\u0633\u0686\u0646-\u0627\u06cc\u0646\u0633\u0631\u0646\u06af-vqa",children:"\u0648\u06cc\u0698\u0648\u0626\u0644 \u06a9\u0648\u0626\u0633\u0686\u0646 \u0627\u06cc\u0646\u0633\u0631\u0646\u06af (VQA)"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u0648\u06cc\u0698\u0648\u0626\u0644 \u06a9\u0648\u0626\u0633\u0686\u0646 \u0627\u06cc\u0646\u0633\u0631\u0646\u06af"}),' \u0627\u0645\u06cc\u062c \u06a9\u06cc \u0633\u0645\u062c\u06be \u06a9\u0648 \u0632\u0628\u0627\u0646\u06cc \u062a\u0641\u06c1\u06cc\u0645 \u06a9\u06d2 \u0633\u0627\u062a\u06be \u062c\u0648\u0691\u062a\u06cc \u06c1\u06d2 \u062a\u0627\u06a9\u06c1 \u0648\u06cc\u0698\u0648\u0626\u0644 \u0645\u0646\u0627\u0638\u0631 \u06a9\u06d2 \u0628\u0627\u0631\u06d2 \u0645\u06cc\u06ba \u06a9\u06be\u0644\u06d2 \u0627\u062e\u062a\u062a\u0627\u0645 \u0648\u0627\u0644\u06d2 \u0633\u0648\u0627\u0644\u0627\u062a \u06a9\u06d2 \u062c\u0648\u0627\u0628\u0627\u062a \u062f\u06cc\u06d2 \u062c\u0627 \u0633\u06a9\u06cc\u06ba\u06d4 \u06c1\u06cc\u0648\u0645\u0646\u0648\u0627\u0626\u0688 \u0631\u0648\u0628\u0648\u0679\u0633 \u06a9\u06d2 \u0644\u0626\u06d2\u060c VQA \u0633\u06cc\u0686\u0648\u0626\u06cc\u0634\u0646\u0644 \u0648\u0627\u0631\u0646\u06cc\u0633 \u06a9\u0648 \u0641\u0639\u0627\u0644 \u06a9\u0631\u062a\u0627 \u06c1\u06d2: "\u06a9\u06cc\u0627 \u062f\u0631\u0648\u0627\u0632\u06c1 \u06a9\u06be\u0644\u0627 \u06c1\u06d2\u061f"\u060c "\u06a9\u0645\u0631\u06d2 \u0645\u06cc\u06ba \u06a9\u062a\u0646\u06d2 \u0644\u0648\u06af \u06c1\u06cc\u06ba\u061f"\u060c "\u0645\u06cc\u0632 \u067e\u0631 \u0645\u0648\u062c\u0648\u062f \u0634\u06d2 \u06a9\u0627 \u0631\u0646\u06af \u06a9\u06cc\u0627 \u06c1\u06d2\u061f"']}),"\n",(0,t.jsx)(r.h3,{id:"gpt-4v-\u0648\u0698\u0646-\u06a9\u06d2-\u0633\u0627\u062a\u06be-vqa",children:"GPT-4V (\u0648\u0698\u0646) \u06a9\u06d2 \u0633\u0627\u062a\u06be VQA"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-python",children:'import base64\r\nimport requests\r\n\r\ndef answer_visual_question(image_path: str, question: str) -> str:\r\n    """\r\n    GPT-4V \u06a9\u0627 \u0627\u0633\u062a\u0639\u0645\u0627\u0644 \u06a9\u0631\u062a\u06d2 \u06c1\u0648\u0626\u06d2 \u0627\u0645\u06cc\u062c \u06a9\u06d2 \u0628\u0627\u0631\u06d2 \u0645\u06cc\u06ba \u0633\u0648\u0627\u0644\u0627\u062a \u06a9\u06d2 \u062c\u0648\u0627\u0628\u0627\u062a \u062f\u06cc\u06ba\u06d4\r\n\r\n    Args:\r\n        image_path: \u0627\u0645\u06cc\u062c \u0641\u0627\u0626\u0644 \u06a9\u0627 \u0631\u0627\u0633\u062a\u06c1\r\n        question: \u0642\u062f\u0631\u062a\u06cc \u0632\u0628\u0627\u0646 \u06a9\u0627 \u0633\u0648\u0627\u0644\r\n    Returns:\r\n        str: GPT-4V \u0633\u06d2 \u062c\u0648\u0627\u0628\r\n    """\r\n    # API \u0679\u0631\u0627\u0646\u0633\u0645\u06cc\u0634\u0646 \u06a9\u06d2 \u0644\u0626\u06d2 \u0627\u0645\u06cc\u062c \u06a9\u0648 \u0628\u06cc\u063364 \u0645\u06cc\u06ba \u0627\u0646\u06a9\u0648\u0688 \u06a9\u0631\u06cc\u06ba\r\n    with open(image_path, "rb") as image_file:\r\n        image_data = base64.b64encode(image_file.read()).decode(\'utf-8\')\r\n\r\n    headers = {\r\n        "Content-Type": "application/json",\r\n        "Authorization": f"Bearer {os.getenv(\'OPENAI_API_KEY\')}"\r\n    }\r\n\r\n    # \u0645\u0644\u0679\u06cc \u0645\u0648\u0688\u0644 \u067e\u0631\u0648\u0645\u067e\u0679 \u062a\u06cc\u0627\u0631 \u06a9\u0631\u06cc\u06ba\r\n    payload = {\r\n        "model": "gpt-4-vision-preview",\r\n        "messages": [\r\n            {\r\n                "role": "user",\r\n                "content": [\r\n                    {\r\n                        "type": "text",\r\n                        "text": question\r\n                    },\r\n                    {\r\n                        "type": "image_url",\r\n                        "image_url": {\r\n                            "url": f"data:image/jpeg;base64,{image_data}"\r\n                        }\r\n                    }\r\n                ]\r\n            }\r\n        ],\r\n        "max_tokens": 300\r\n    }\r\n\r\n    # API \u062f\u0631\u062e\u0648\u0627\u0633\u062a \u0628\u06be\u06cc\u062c\u06cc\u06ba\r\n    response = requests.post(\r\n        "https://api.openai.com/v1/chat/completions",\r\n        headers=headers,\r\n        json=payload\r\n    )\r\n\r\n    # \u062c\u0648\u0627\u0628 \u0646\u06a9\u0627\u0644\u06cc\u06ba\r\n    result = response.json()\r\n    answer = result[\'choices\'][0][\'message\'][\'content\']\r\n    return answer\r\n\r\n# \u0645\u062b\u0627\u0644: \u0645\u0646\u0638\u0631 \u06a9\u06cc \u0633\u0645\u062c\u06be \u06a9\u06d2 \u0644\u0626\u06d2 \u0633\u0648\u0627\u0644\u0627\u062a\r\nquestions = [\r\n    "How many mugs are on the table?",\r\n    "What color is the leftmost mug?",\r\n    "Is there a laptop visible in the image?",\r\n    "Describe the spatial arrangement of objects on the desk."\r\n]\r\n\r\nfor q in questions:\r\n    answer = answer_visual_question("desk_scene.jpg", q)\r\n    print(f"Q: {q}")\r\n    print(f"A: {answer}\\n")\r\n\r\n# Output:\r\n# Q: How many mugs are on the table?\r\n# A: There are three mugs visible on the table.\r\n#\r\n# Q: What color is the leftmost mug?\r\n# A: The leftmost mug is red with a white handle.\n'})}),"\n",(0,t.jsx)(r.h2,{id:"\u0648\u0698\u0646-\u0632\u0628\u0627\u0646-\u06a9\u0627-\u0631\u0648\u0628\u0648\u0679-\u06a9\u0646\u0679\u0631\u0648\u0644-\u06a9\u06d2-\u0633\u0627\u062a\u06be-\u0627\u0646\u0636\u0645\u0627\u0645",children:"\u0648\u0698\u0646-\u0632\u0628\u0627\u0646 \u06a9\u0627 \u0631\u0648\u0628\u0648\u0679 \u06a9\u0646\u0679\u0631\u0648\u0644 \u06a9\u06d2 \u0633\u0627\u062a\u06be \u0627\u0646\u0636\u0645\u0627\u0645"}),"\n",(0,t.jsx)(r.p,{children:"CLIP \u062c\u0691\u0627\u0624 \u06a9\u0648 ROS 2 \u0627\u06cc\u06a9\u0634\u0646 \u0633\u0631\u0648\u0631\u0632 \u06a9\u06d2 \u0633\u0627\u062a\u06be \u0628\u0646\u062f \u0644\u0648\u067e \u0645\u06cc\u0646\u0648\u067e\u0648\u0644\u06cc\u0634\u0646 \u06a9\u06d2 \u0644\u0626\u06d2 \u062c\u0648\u0691\u06cc\u06ba:"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-python",children:'import rclpy\r\nfrom rclpy.node import Node\r\nfrom geometry_msgs.msg import Point\r\n\r\nclass VisionLanguageGrasping(Node):\r\n    """\r\n    ROS 2 \u0646\u0648\u0688 \u062c\u0648 CLIP \u06a9\u0627 \u0627\u0633\u062a\u0639\u0645\u0627\u0644 \u06a9\u0631\u062a\u0627 \u06c1\u06d2 \u0627\u0634\u06cc\u0627\u0621 \u06a9\u0648 \u062a\u0644\u0627\u0634 \u06a9\u0631\u0646\u06d2 \u0627\u0648\u0631 \u0631\u0648\u0628\u0648\u0679 \u06a9\u0648 \u06af\u0631\u06cc\u0633\u0646\u06af \u06a9\u06d2 \u0644\u0626\u06d2 \u06a9\u0645\u0627\u0646\u0688 \u062f\u06cc\u0646\u06d2 \u06a9\u06d2 \u0644\u0626\u06d2\u06d4\r\n    """\r\n\r\n    def __init__(self):\r\n        super().__init__(\'vision_language_grasping\')\r\n\r\n        # \u06a9\u06cc\u0645\u0631\u06c1 \u0627\u0645\u06cc\u062c\u0632 \u06a9\u06d2 \u0644\u0626\u06d2 \u0633\u0628\u0633\u06a9\u0631\u0627\u0626\u0628 \u06a9\u0631\u06cc\u06ba\r\n        self.subscription = self.create_subscription(\r\n            Image,\r\n            \'/camera/image_raw\',\r\n            self.image_callback,\r\n            10\r\n        )\r\n\r\n        # \u06af\u0631\u06cc\u0633 \u0679\u0627\u0631\u06af\u06cc\u0679 \u067e\u0648\u0632\u06cc\u0634\u0646\u0632 \u06a9\u06d2 \u0644\u0626\u06d2 \u067e\u0628\u0644\u0634\u0631\r\n        self.grasp_pub = self.create_publisher(Point, \'/grasp_target\', 10)\r\n\r\n        self.current_image = None\r\n\r\n    def image_callback(self, msg):\r\n        """\u062a\u0627\u0632\u06c1 \u062a\u0631\u06cc\u0646 \u06a9\u06cc\u0645\u0631\u06c1 \u0627\u0645\u06cc\u062c \u0627\u0633\u0679\u0648\u0631 \u06a9\u0631\u06cc\u06ba\u06d4"""\r\n        # ROS \u0627\u0645\u06cc\u062c \u0645\u06cc\u0633\u062c \u06a9\u0648 PIL \u0627\u0645\u06cc\u062c \u0645\u06cc\u06ba \u062a\u0628\u062f\u06cc\u0644 \u06a9\u0631\u06cc\u06ba\r\n        self.current_image = self.ros_to_pil_image(msg)\r\n\r\n    def grasp_object_by_description(self, description: str):\r\n        """\r\n        \u062a\u0641\u0635\u06cc\u0644 \u0633\u06d2 \u0645\u0645\u0627\u062b\u0644 \u0634\u06d2 \u062a\u0644\u0627\u0634 \u06a9\u0631\u06cc\u06ba \u0627\u0648\u0631 \u06af\u0631\u06cc\u0633 \u0679\u0627\u0631\u06af\u06cc\u0679 \u0634\u0627\u0626\u0639 \u06a9\u0631\u06cc\u06ba\u06d4\r\n\r\n        Args:\r\n            description: \u0679\u06cc\u06a9\u0633\u0679 \u062a\u0641\u0635\u06cc\u0644 (\u0645\u062b\u0644\u0627\u064b "the blue screwdriver")\r\n        """\r\n        if self.current_image is None:\r\n            self.get_logger().warn("No camera image available")\r\n            return\r\n\r\n        # \u0634\u06d2 \u062a\u0644\u0627\u0634 \u06a9\u0631\u0646\u06d2 \u06a9\u06d2 \u0644\u0626\u06d2 CLIP \u06a9\u0627 \u0627\u0633\u062a\u0639\u0645\u0627\u0644 \u06a9\u0631\u06cc\u06ba\r\n        detections = detect_objects_with_clip(\r\n            self.current_image,\r\n            [description],\r\n            grid_size=8\r\n        )\r\n\r\n        if detections:\r\n            desc, x, y, score = detections[0]\r\n            self.get_logger().info(\r\n                f"Found \'{desc}\' at pixel ({x}, {y}) with confidence {score:.2f}"\r\n            )\r\n\r\n            # \u067e\u06a9\u0633\u0644 \u06a9\u0648\u0622\u0631\u0688\u06cc\u0646\u06cc\u0679\u0633 \u06a9\u0648 3D \u067e\u0648\u0627\u0626\u0646\u0679 \u0645\u06cc\u06ba \u062a\u0628\u062f\u06cc\u0644 \u06a9\u0631\u06cc\u06ba (\u06a9\u06cc\u0645\u0631\u06c1 \u06a9\u06cc\u0644\u06cc\u0628\u0631\u06cc\u0634\u0646 \u06a9\u06cc \u0636\u0631\u0648\u0631\u062a \u06c1\u06d2)\r\n            grasp_point = self.pixel_to_3d(x, y)\r\n\r\n            # \u0645\u06cc\u0646\u0648\u067e\u0648\u0644\u06cc\u0634\u0646 \u06a9\u0646\u0679\u0631\u0648\u0644\u0631 \u06a9\u06d2 \u0644\u0626\u06d2 \u06af\u0631\u06cc\u0633 \u0679\u0627\u0631\u06af\u06cc\u0679 \u0634\u0627\u0626\u0639 \u06a9\u0631\u06cc\u06ba\r\n            self.grasp_pub.publish(grasp_point)\r\n\r\n    def pixel_to_3d(self, x: int, y: int) -> Point:\r\n        """\r\n        2D \u067e\u06a9\u0633\u0644 \u06a9\u0648 3D \u067e\u0648\u0627\u0626\u0646\u0679 \u0645\u06cc\u06ba \u062a\u0628\u062f\u06cc\u0644 \u06a9\u0631\u06cc\u06ba \u0688\u06cc\u067e\u062a\u06be \u0633\u06cc\u0646\u0633\u0631 \u0627\u0648\u0631 \u06a9\u06cc\u0645\u0631\u06c1 \u0627\u0646\u0679\u0631\u0646\u0633\u06a9\u0633 \u06a9\u0627 \u0627\u0633\u062a\u0639\u0645\u0627\u0644 \u06a9\u0631\u062a\u06d2 \u06c1\u0648\u0626\u06d2\u06d4\r\n        (\u0633\u0627\u062f\u06c1\u061b \u062d\u0642\u06cc\u0642\u06cc \u0627\u0645\u067e\u0644\u06cc\u0645\u0646\u0679\u06cc\u0634\u0646 \u06a9\u0648 camera_info \u0627\u0648\u0631 depth_image \u06a9\u06cc \u0636\u0631\u0648\u0631\u062a \u06c1\u06d2)\r\n        """\r\n        point = Point()\r\n        point.x = float(x) * 0.001  # \u0646\u0645\u0648\u0646\u06c1 \u062a\u0628\u062f\u06cc\u0644\u06cc\r\n        point.y = float(y) * 0.001\r\n        point.z = 0.5  # \u0641\u06a9\u0633\u0688 \u0688\u06cc\u067e\u062a\u06be \u06a9\u0627 \u0641\u0631\u0636 \u06a9\u0631\u06cc\u06ba\r\n        return point\r\n\r\n# ROS 2 \u06a9\u06d2 \u0633\u06cc\u0627\u0642 \u0645\u06cc\u06ba \u0645\u062b\u0627\u0644 \u06a9\u0627 \u0627\u0633\u062a\u0639\u0645\u0627\u0644\r\ndef main():\r\n    rclpy.init()\r\n    node = VisionLanguageGrasping()\r\n\r\n    # \u0631\u0648\u0628\u0648\u0679 \u06a9\u0648 \u0634\u06d2 \u06af\u0631\u06cc\u0633\u0646\u06af \u06a9\u06d2 \u0644\u0626\u06d2 \u06a9\u0645\u0627\u0646\u0688 \u062f\u06cc\u06ba\r\n    node.grasp_object_by_description("the red coffee mug")\r\n\r\n    rclpy.spin(node)\n'})}),"\n",(0,t.jsx)(r.h2,{id:"\u0645\u0634\u0642-\u0648\u0631\u0632\u0634",children:"\u0645\u0634\u0642 \u0648\u0631\u0632\u0634"}),"\n",(0,t.jsx)(r.p,{children:"\u0648\u06cc\u0698\u0648\u0626\u0644 \u0633\u0631\u0686 \u0633\u0633\u0679\u0645 \u062a\u06cc\u0627\u0631 \u06a9\u0631\u06cc\u06ba:"}),"\n",(0,t.jsxs)(r.ol,{children:["\n",(0,t.jsx)(r.li,{children:"\u0631\u0648\u0628\u0648\u0679 \u06a9\u06d2 \u06a9\u06cc\u0645\u0631\u06c1 \u0633\u06d2 \u0627\u0645\u06cc\u062c \u06a9\u06cc\u067e\u0686\u0631 \u06a9\u0631\u06cc\u06ba"}),"\n",(0,t.jsx)(r.li,{children:'\u0635\u0627\u0631\u0641 \u0679\u06cc\u06a9\u0633\u0679 \u06a9\u0648\u06cc\u0631\u06cc \u0641\u0631\u0627\u06c1\u0645 \u06a9\u0631\u062a\u0627 \u06c1\u06d2: "\u06af\u0631\u06cc\u0646 \u0628\u0648\u062a\u0644 \u062a\u0644\u0627\u0634 \u06a9\u0631\u06cc\u06ba"'}),"\n",(0,t.jsx)(r.li,{children:"CLIP \u06a9\u0627 \u0627\u0633\u062a\u0639\u0645\u0627\u0644 \u06a9\u0631\u062a\u06d2 \u06c1\u0648\u0626\u06d2 \u0634\u06d2 \u062a\u0644\u0627\u0634 \u06a9\u0631\u06cc\u06ba \u0627\u0648\u0631 \u0628\u0627\u0624\u0646\u0688\u0646\u06af \u0628\u0627\u06a9\u0633 \u06a9\u0627 \u062d\u0633\u0627\u0628 \u0644\u06af\u0627\u0626\u06cc\u06ba"}),"\n",(0,t.jsx)(r.li,{children:"\u0631\u0648\u0628\u0648\u0679 \u06a9\u0648 \u0634\u06d2 \u06a9\u0627 \u0633\u0627\u0645\u0646\u0627 \u06a9\u0631\u0646\u06d2 \u06a9\u06d2 \u0644\u0626\u06d2 \u0646\u06cc\u0648\u06cc \u06af\u06cc\u0679 \u06a9\u0631\u06cc\u06ba (\u06a9\u06cc\u0645\u0631\u06c1 \u067e\u06cc\u0646 \u06cc\u0627 \u0628\u06cc\u0633 \u0645\u0646\u062a\u0642\u0644 \u06a9\u0631\u06cc\u06ba)"}),"\n",(0,t.jsx)(r.li,{children:"\u062a\u0635\u062f\u06cc\u0642 \u06a9\u0631\u06cc\u06ba \u06a9\u06c1 \u0634\u06d2 \u0645\u06cc\u0646\u0648\u067e\u0648\u0644\u06cc\u0634\u0646 \u0648\u0631\u06a9 \u0633\u067e\u06cc\u0633 \u0645\u06cc\u06ba \u06c1\u06d2"}),"\n"]}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"\u062e\u0635\u0648\u0635\u06cc\u062a \u0631\u06cc\u0632\u0646\u0646\u06af"}),' \u06a9\u06d2 \u0633\u0627\u062a\u06be \u0628\u0691\u06be\u0627\u0626\u06cc\u06ba: "\u062f\u0648 \u0645\u06af\u0648\u06ba \u0645\u06cc\u06ba \u0633\u06d2 \u0628\u0691\u0627" (\u0633\u0627\u0626\u0632 \u06a9\u0627 \u0645\u0648\u0627\u0632\u0646\u06c1 \u06a9\u06cc \u0636\u0631\u0648\u0631\u062a \u06c1\u06d2) \u06cc\u0627 "\u06a9\u0646\u0627\u0631\u06d2 \u06a9\u06d2 \u0642\u0631\u06cc\u0628 \u062a\u0631\u06cc\u0646 \u0645\u06af" (\u0633\u067e\u06cc\u0634\u0644 \u0631\u06cc\u0632\u0646\u0646\u06af) \u062c\u06cc\u0633\u06d2 \u0633\u0648\u0627\u0644\u0627\u062a \u06a9\u0648 \u0633\u0646\u0628\u06be\u0627\u0644\u06cc\u06ba\u06d4']}),"\n",(0,t.jsx)(r.h2,{id:"\u0627\u06af\u0644\u06d2-\u0627\u0642\u062f\u0627\u0645\u0627\u062a",children:"\u0627\u06af\u0644\u06d2 \u0627\u0642\u062f\u0627\u0645\u0627\u062a"}),"\n",(0,t.jsxs)(r.p,{children:["\u0622\u067e \u0646\u06d2 \u0627\u0634\u06cc\u0627\u0621 \u06a9\u06cc \u062c\u0691\u0627\u0624 \u06a9\u06d2 \u0644\u0626\u06d2 \u0632\u0628\u0627\u0646 \u06a9\u0648 \u0648\u0698\u0646 \u0633\u06d2 \u062c\u0648\u0691 \u062f\u06cc\u0627 \u06c1\u06d2\u06d4 ",(0,t.jsx)(r.strong,{children:"\u06c1\u0641\u062a\u06c1 12: \u06af\u06cc\u0633\u0686\u0631 \u0631\u06cc\u06a9\u0648\u06af\u0646\u06cc\u0634\u0646"})," \u0645\u06cc\u06ba\u060c \u0622\u067e MediaPipe \u06a9\u0627 \u0627\u0633\u062a\u0639\u0645\u0627\u0644 \u06a9\u0631\u062a\u06d2 \u06c1\u0648\u0626\u06d2 \u0627\u0646\u0633\u0627\u0646\u06cc \u067e\u0648\u0632 \u0679\u0631\u06cc\u06a9\u0646\u06af \u0634\u0627\u0645\u0644 \u06a9\u0631\u06cc\u06ba \u06af\u06d2\u060c \u0631\u0648\u0628\u0648\u0679\u0633 \u06a9\u0648 \u0627\u0634\u0627\u0631\u0648\u06ba \u0627\u0648\u0631 \u0628\u062f\u0646 \u06a9\u06cc \u0632\u0628\u0627\u0646 \u06a9\u06cc \u062a\u0634\u0631\u06cc\u062d \u06a9\u0631\u0646\u06d2 \u06a9\u06cc \u0627\u062c\u0627\u0632\u062a \u062f\u06cc\u06ba \u06af\u06d2 \u0642\u062f\u0631\u062a\u06cc \u0627\u0646\u0633\u0627\u0646-\u0631\u0648\u0628\u0648\u0679 \u0627\u0646\u0679\u0631\u0627\u06cc\u06a9\u0634\u0646 \u06a9\u06d2 \u0644\u0626\u06d2\u06d4"]})]})}function p(e={}){const{wrapper:r}={...(0,s.R)(),...e.components};return r?(0,t.jsx)(r,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,r,n)=>{n.d(r,{R:()=>o,x:()=>a});var i=n(6540);const t={},s=i.createContext(t);function o(e){const r=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function a(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),i.createElement(s.Provider,{value:r},e.children)}}}]);